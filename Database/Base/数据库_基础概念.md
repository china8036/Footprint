- [数据库：基础概念](#%E6%95%B0%E6%8D%AE%E5%BA%93%EF%BC%9A%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5)
  - [1. 概述](#1-%E6%A6%82%E8%BF%B0)
    - [1.1. 基本概念](#11-%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5)
    - [1.2. 数据管理技术发展](#12-%E6%95%B0%E6%8D%AE%E7%AE%A1%E7%90%86%E6%8A%80%E6%9C%AF%E5%8F%91%E5%B1%95)
    - [1.3. 数据库系统的特点](#13-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%89%B9%E7%82%B9)
  - [2. 数据模型](#2-%E6%95%B0%E6%8D%AE%E6%A8%A1%E5%9E%8B)
    - [2.1. 概念模型 / 信息模型](#21-%E6%A6%82%E5%BF%B5%E6%A8%A1%E5%9E%8B-%E4%BF%A1%E6%81%AF%E6%A8%A1%E5%9E%8B)
    - [2.2. 逻辑模型](#22-%E9%80%BB%E8%BE%91%E6%A8%A1%E5%9E%8B)
    - [2.3. 物理模型](#23-%E7%89%A9%E7%90%86%E6%A8%A1%E5%9E%8B)
  - [3. 数据库系统的结构](#3-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%BB%93%E6%9E%84)
    - [3.1. 数据库系统模式](#31-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E6%A8%A1%E5%BC%8F)
    - [3.2. 数据库系统的三级模式结构](#32-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E7%9A%84%E4%B8%89%E7%BA%A7%E6%A8%A1%E5%BC%8F%E7%BB%93%E6%9E%84)
      - [3.2.1. 内模式](#321-%E5%86%85%E6%A8%A1%E5%BC%8F)
      - [3.2.2. 模式](#322-%E6%A8%A1%E5%BC%8F)
      - [3.2.3. 外模式](#323-%E5%A4%96%E6%A8%A1%E5%BC%8F)
    - [3.3. 数据库的二级映像功能](#33-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E4%BA%8C%E7%BA%A7%E6%98%A0%E5%83%8F%E5%8A%9F%E8%83%BD)
      - [3.3.1. 外模式 / 模式映像](#331-%E5%A4%96%E6%A8%A1%E5%BC%8F-%E6%A8%A1%E5%BC%8F%E6%98%A0%E5%83%8F)
      - [3.3.2. 模式 / 内模式映像](#332-%E6%A8%A1%E5%BC%8F-%E5%86%85%E6%A8%A1%E5%BC%8F%E6%98%A0%E5%83%8F)

# 数据库：基础概念

数据库是长期储存在计算机内、有组织的、可共享的大量数据的集合。数据库可供各种用户共享，具有最小冗余度和较高的数据独立性。数据库管理系统在数据库建立、运用和维护时对数据库进行统一控制，以保证数据的完整性和安全性，并在多用户同时使用数据库时进行并发控制，在发生故障后对数据库进行恢复。

## 1. 概述

### 1.1. 基本概念

- 数据（Data）

  描述事物的符号记录称为数据。数据是数据库中存储的基本对象。

- 数据库（DB）

  数据库是长期储存在计算机内、有组织的、可共享的大量数据的集合。

- 数据库管理系统（DBMS）

  数据库管理系统是位于用户与操作系统之间的一层数据管理软件。

- 数据库系统（DBS）

  数据库系统是由数据库、数据库管理系统（及其应用开发工具）、应用程序和数据库管理员组成的存储、管理、处理和维护数据的系统。

### 1.2. 数据管理技术发展

数据库技术是应数据管理任务的需要而产生的。在应用需求的推动下，在计算机硬件、软件发展的基础上，数据管理技术主要经历了以下几个阶段：
- 人工管理阶段
- 文件系统阶段
- 数据库系统阶段

数据库系统的出现使信息系统从以加工数据的程序为中心转向围绕共享的数据库为中心的新阶段。

### 1.3. 数据库系统的特点

- 整体数据结构化

  数据库系统实现整体数据的结构化，这是数据库的主要特征之一，也是数据库系统与文件系统的本质区别。

  “整体”指的是数据库中的数据不再仅仅针对某一个应用，而是面向整个组织或企业；不仅数据内部是结构化的，而是整体是结构化的，数据之间是具有联系的。

- 数据的共享性高、冗余度低、易扩充

  数据库系统从整体角度看待和描述数据，数据不再面向单个应用而是面向整个系统，因此数据可以被多个用户、多个应用共享使用。数据共享减少了数据冗余，且容易增加新的应用，使得系统弹性大、易扩充。

- 数据独立性高

  数据库的数据独立性是由数据库管理系统提供的二级映像功能来保证的。

  - 物理独立性：用户的应用程序与数据库中的数据的物理存储是相互独立的。
  - 逻辑独立性：用户的应用程序与数据库的逻辑结构是相互独立的。

- 数据由数据库管理系统统一管理和控制

  数据库管理系统必须提供以下几方面的数据控制功能：
  - 数据的安全性保护
  - 数据的完整性检查
  - 并发控制
  - 数据库恢复

## 2. 数据模型

数据模型是对真实世界数据特征的抽象，是现实世界的模拟，也是数据库系统的核心和基础。

数据模型精确描述了系统的静态特性、动态特性和完整性约束条件。通常由以下三部分组成：
- 数据结构：数据结构描述数据库组成对象以及对象之间的联系。
- 数据操作：数据操作指对数据库中各种对象（型）的实例（值）运行执行的操作的集合，包括操作及有关的操作规则。
- 数据的完整性约束条件：数据的完整性约束条件是一组完整性规则，是给定的数据模型中数据及其联系所具有的制约和依存规则，用以限定符合数据模型的数据库状态以及状态的变化，以保证数据的正确、有效和相容。

数据模型应满足三方面的要求：
- 能比较真实的模拟现实世界
- 容易为人所理解
- 便于在计算机上实现
因此，在数据库系统中针对不同的使用对象和应用目的，采用不同的数据模型。为将现实世界中的具体事物抽象、组织成为某一数据库管理系统支持的数据模型，通常首先将现实世界抽象为信息世界，然后将信息世界转换为及机器世界。

### 2.1. 概念模型 / 信息模型

按用户的观点对数据和信息进行建模，主要用于数据库设计。

概念模型有很多种表示方法，其中最常用的是实体 - 联系方法（Entity-relationship approach），该方法用 E-R 图来描述现实世界中的概念模型。其中，使用矩形表示实体，使用圆形表示实体属性，使用菱形表示实体之间的联系。

### 2.2. 逻辑模型

按计算机系统的观点对数据建模，主要用于数据库管理系统的实现。

数据库领域常见的逻辑数据模型：
- **格式化数据模型**
  - 层次模型：数据库系统中最早出现的数据模型，层次模型就像一颗倒立的树，结点的双亲是唯一的。记录之间是 1:n 的关系。
  - 网状模型：典型代表是 DBTG 系统（CODASYL 系统），网状模型中子女结点与双亲结点的联系可以是不唯一的。记录之间是 m:n 的关系。

- **关系模型**
  
  1970 年 IBM 的 E.F.Codd 首次提出，是最重要的一种数据模型，关系数据库系统采用该模型作为数据的组织方式。
  - 数据结构
    
    关系模型不同于格式化数据模型，它建立在严格的数据概念的基础上。从用户观点上看，关系模型由一组关系组成。每个关系的数据结构是一张规范化的二维表。

  - 数据操纵

    关系模型的数据操纵主要包括查询、插入、删除和更新数据。

  - 完整性约束条件

    关系模型的数据操纵必须满足关系的完整性约束条件：
    - 实体完整性
    - 参照完整性
    - 用户定义的完整性

- 面向对象数据模型
- 对象关系数据模型
- 半结构化数据模型

### 2.3. 物理模型

按计算机系统的观点，对数据最底层的抽象。描述了数据在系统内部的表示方式和存取方法，或在磁盘上的存储方式和存取方法。

物理模型的具体实现是数据库管理系统的任务，数据库设计人员要了解和选择物理模型，数据库的最终用户则不需要考虑物理级的细节。

## 3. 数据库系统的结构

从数据库开发人员角度上看，数据库系统通常采用三级模式结构，这是数据库系统内部的系统结构。

从数据库最终用户角度看，数据库系统的结构分为单用户结构、主从式结构、分布式结构、客户 - 服务器、浏览器 - 应用服务器 / 数据库服务器多层结构等，这是数据库系统外部的系统结构。

### 3.1. 数据库系统模式

模式 schema 是数据库中全体数据的逻辑结构和特征的描述，它仅仅设计型的描述，不涉及具体的值。模式的一个具体值称为模式的一个实例，同一个模式可以有很多个实例。

模式是相对稳定的，而实例是相对变动的。

### 3.2. 数据库系统的三级模式结构

数据库系统的三级模式结构是指数据库系统是由外模式、模式和内模式三级构成。

#### 3.2.1. 内模式

内模式 / 存储模式，是数据物理结构和存储方式的描述，是数据在数据库内部的组织方式。例如，记录的存储方式是堆存储还是按照某些属性值的顺序存储，或按照属性值 cluster 存储；索引按照什么方式组织，是 B+ 树索引还是 Hash 索引；数据是否压缩存储，是否加密；数据的存储记录结构有何规定（定长结构或变长结构），一个记录不能跨物理页存储等。

**一个数据库只能有一个内模式。**

#### 3.2.2. 模式

模式 / 逻辑模式，是数据库中全体数据的逻辑结构和特征的描述，是所有用户的公共数据视图。它是数据库系统模式结构中的中间层，既不涉及数据的物理存储细节和硬件环境，又与具体的应用程序、所使用的应用开发工具及高级程序设计语言无关。

数据库的模式是数据库的全局逻辑结构，是数据库的中心和关键，它独立于数据库的其他层次。因此**设计数据库模式结构时应首先确定数据库的逻辑模式。**

**一个数据库只有一个模式。**

数据库管理系统提供模式数据定义语言（模式 DDL）来严格地定义模式。

#### 3.2.3. 外模式

外模式 / 子模式 / 用户模式，是数据库用户（包括应用程序员和最终用户）能够看见和使用的局部数据的逻辑结构和特征的描述，是数据库用户的数据视图，是某一个应用有关的数据的逻辑表示。

外模式通常是模式的子集，**一个数据库可以有多个外模式**，但每个用户只能看见和访问所对应的外模式中的数据。

数据库管理系统提供外模式数据定义语言（外模式 DDL）来严格地定义外模式。

### 3.3. 数据库的二级映像功能

数据库系统的三级模式是数据的三个抽象级别，它将数据的具体组织留给数据库管理系统管理，使得用户能逻辑地、抽象地处理数据，而不必关系数据在计算机中的具体表示方式和存储方式。为能够在系统内部实现这三个抽象层次的联系和转换，数据库管理系统在这三级模式之间提供了二级映像，从而保证了数据库系统的数据能够具有较高的逻辑独立性和物理独立性。

#### 3.3.1. 外模式 / 模式映像

模式描述的是数据的全局逻辑结构，外模式描述的是数据的局部逻辑结构。对应于同一个模式可以有任意多个外模式，对于每个外模式，数据库系统都有一个外模式 / 模式映像，它定义了该外模式与模式之间的对应关系，映像的定义通常包含在各自外模式的描述中。

当模式改变时，由数据库管理员对各个外模式 / 模式的映像作相应改变，可以使得外模式保持不变。应用程序是依据数据的外模式编写的，从而应用程序不必修改，保证了数据与程序的逻辑独立性，即数据的逻辑独立性。

#### 3.3.2. 模式 / 内模式映像

数据库中的模式和内模式都是唯一的，因此模式 / 内模式映像也是唯一的，它定义了数据全局逻辑结构与存储结构之间的对应关系。

当数据库的存储结构改变时，由数据库管理员对模式 / 内模式映像作相应改变，可以使得模式保持不变，从而应用程序也不必改变，保证了数据与程序的物理独立性，即数据的物理独立性。