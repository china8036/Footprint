- [正则表达式：POSIX 标准](#正则表达式posix-标准)
  - [1. 元字符 (metacharacter)](#1-元字符-metacharacter)
  - [2. 非打印字符](#2-非打印字符)
  - [3. 字符集和字符类](#3-字符集和字符类)
  - [4. 运算优先级](#4-运算优先级)
  - [5. 常用正则工具](#5-常用正则工具)
  - [6. Refer Links](#6-refer-links)

# 正则表达式：POSIX 标准

一个正则表达式由正则字符（普通字符）（如字母，数字，逗号等）和元字符（特殊字符）（如*，+，- 等）构成，相当于一个数学表达式中的数字和运算符。

## 1. 元字符 (metacharacter)

- BRE metacharacter

  基础正则表达式（BRE）中的元字符：
  - `\`	转义符，若后接特殊字符，则将该特殊字符视为普通字符；若后接普通字符，则将该字符和、的组合视为具有特殊含义的非打印字符。
    - eg: `\n` 匹配换行符。
    - eg: `\\` 匹配 `\`。
    - eg: `\(` 则匹配 `(`。
  - `^`	行首定位符，规定 pattern 必须出现在行首才能匹配。
  - `$`	行尾定位符，规定 pattern 必须出现在行尾才能匹配。
  - `.`	匹配任意一个字符（可单独使用）。
  - `*`	匹配任意多个**前导字符（不可单独使用）**。
  - `[ ]`	匹配方括号中字符的任意一个。
  - `[^]`	匹配除方括号中的字符之外的任意一个字符。
  - `[-]`	匹配方括号内字符范围中的任意一个字符。
    - eg: `grep '[a-zA-Z\*\+]' file` 可匹配任意一个字母、星号、加号。
  - `\<`	匹配单词头的空格。
  - `\>`	匹配单词尾的空格。

- ERE metacharacter

  扩展正则表达式（ERE）中除了具有 BRE 的所有元字符外，还扩展了以下特有的元字符：
  - `?`	匹配 0 个或 1 个**前导字符（不可单独使用）**。
    - eg: `egrep ‘ab?c’ file` 可匹配 ac 和 abc；
  - `+`	匹配 1 个或多个**前导字符（不可单独使用）**。
    - eg: `egrep ‘ab+c’ file` 可匹配 abc、abbc、abbbbbbc 等。
  - `{}`	为前导字符指定一个最小或最大匹配的数目（不可单独使用）。
    - eg: `egrep ‘ab{3}c’ file` 可匹配 abbbc。
    - eg: `egrep ‘ab{3,}c’ file` 可匹配 abbbc, abbbbbc, abbbbbbbbbc 等。
    - eg: `egrep ‘ab{3,4}c’ file` 可匹配 abbbc 和 abbbbc。
    注： 必须指定匹配数目的下限，即不存在 ‘ab{,4}c’ 的写法。
  - `()`	分组。
    - eg: `egrep ‘a(boy)+c’ file` 可匹配 aboyc, aboyboyboyc 等。
  - `|`	或。

  若要在只支持 BRE 的工具中使用 ERE 特有的元字符，需要在该元字符前加上转义符，如：
  ```
  grep ‘^[a-z]{3}|(abc)$’ file; (x)
  grep ‘^[a-z]\{3\}\|\(abc\)$’ file; (√)
  ```
  另外，若在支持 ERE 的工具（如 egrep）中，在 ERE 特有元字符前加上转义符，则该元字符不发挥其特殊作用，被视为普通字符匹配。

NOTE：
- 通配符与正则表达式中的部分元字符相同：*, ?, [ ], { }（没有“.”，“.”不是通配符)，但它们是完全不同的概念：
  - 通配符：系统级别，不需要工具支持，用于文件名的匹配。
  - 正则表达式：需要工具支持，如 grep，awk，sed 等，用于文本内容的匹配。
- `*`、`+`和`?`限定符都是贪婪的，因为它们会尽可能多的匹配文字，只有在它们的后面加上一个？就可以实现非贪婪或最小匹配。
- 不能对定位符（`^`、`$`、`\b`、`\B`）使用限定符。

## 2. 非打印字符

- `\f`: 匹配一个换页符。等价于 \x0c 和 \cL。
- `\n`: 匹配一个换行符。等价于 \x0a 和 \cJ。
- `\r`: 匹配一个回车符。等价于 \x0d 和 \cM。
- `\s`: 匹配任何空白字符，包括空格、制表符、换页符等等。等价于 [ \f\n\r\t\v]。
- `\S`: 匹配任何非空白字符。等价于 [^ \f\n\r\t\v]。
- `\t`: 匹配一个制表符。等价于 \x09 和 \cI。
- `\v`: 匹配一个垂直制表符。等价于 \x0b 和 \cK。

## 3. 字符集和字符类

- 字符集：表示字符的集合，如 [abc]、[a-z] 等。

- 字符类（shorthand）：为方便编程和**避免因语系编码不同而造成的范围误差**，系统对一些常用的字符集进行了预定义，称为字符类。
	
  因为语系编码不同而造成的范围误差：例如：在英文大小写的编码顺序中，zh_CN.big5 和 C 这两种语系的输出结果如下：
  - LANG=zh_CN 时，0123456……ABCD……Zabcd……z
	- LANG=C 时，0123456……aAbBcCdD……zZ
	这就会造成使用 [a-z] 或者 [A-Z] 进行匹配的时候，匹配结果可能出乎预料。
  
  - `[[:alpha:]]`: 任何字母。
  - `[[:digit:]]`: 任何数字。
  - `[[:alnum:]]`: 任何字母和数字。
  - `[[:space:]]`: 任何白字符，包括空格、水平制表符、垂直制表符、换行、换页、回车。
  - `[[:upper:]]`: 任何大写字母。
  - `[[:lower:]]`: 任何小写字母。
  - `[[:punct:]]`: 任何标点符号。
  - `[[:xdigit:]]`: 任何 16 进制的数字，相当于 [0-9a-fA-F]。
  NOTE: 这些 shorthand 规定一定要在 [] 中使用，因此，取反的写法即为：[^[:upper:]].

## 4. 运算优先级

相同优先级的从左到右进行运算，不同优先级的运算先高后低。

各种操作符的优先级从高到低如下：
- `\`: 转义符。
- `(), (?:), (?=), []`: 圆括号和方括号。
- `*, +, ?, {n}, {n,}, {n,m}`: 限定符。
- `^, $, \anymetacharacter`: 位置和顺序。

## 5. 常用正则工具

- grep/egrep/fgrep
  - grep (grep 支持：BREs、EREs、PREs 正则表达式)
    - grep 指令后不跟任何参数，则表示要使用 BREs。
    - grep 指令后跟 `-E` 参数，则表示要使用 EREs。
    - grep 指令后跟 `-P` 参数，则表示要使用 PREs。
    P.S.
    - 使用 grep 的“或”匹配： `grep -E ‘a|b’ file 或 egrep ‘a|b’ file`。
    - 使用 grep 的“和”匹配： `grep 'word1' 文件名 | grep 'word2'`。
  - egrep (egrep 支持：EREs、PREs 正则表达式)
    - egrep 指令后不跟任何参数，则表示要使用 EREs。
    - egrep 指令后跟 `-P` 参数，则表示要使用 PREs。
  - fgrep (fgrep 不支持正则匹配，但搜索速度最快)

- sed (sed 文本工具支持：BREs、EREs)
  - sed 指令默认是使用 BREs。
  - sed 命令参数 `-r` ，则表示要使用 EREs。

- awk/gawk (awk 文本工具支持：EREs)
  - awk 指令默认是使用 EREs。
  NOTE: grep 系和 sed 在处理文本时，都是按行处理的；而 awk 是按列处理的。

- vi
  <!-- TODO: https://www.google.com/search?hl=zh-CN&q=vi%E4%B8%AD%E7%9A%84%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F -->

## 6. Refer Links

TODO:

[正则表达式说明](http://baiy.cn/utils/_regex_doc/index.htm)