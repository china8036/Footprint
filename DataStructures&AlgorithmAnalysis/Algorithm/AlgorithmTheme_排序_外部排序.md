
# 外部排序

内部排序算法所有的操作都是在内存中完成的，算法过程中不需要 I/O，因此算法总体上速度比较快，但也随之出现了一个问题：当需要排序的数据量异常的大的时候，以上的算法就显得力不从心了。

通常设备的内存读取速度要比外存读取速度快得多（RAM 的访问速度大约是磁盘的 25 万倍），但是内存的容量却要比外存小很多，当所有的数据不能在内存中完全放下的时候，就需要使用到外排序。

外排序其实是采用一种分治（Divide and conquer algorithm）的算法设计思想，将一个大问题划分成相对独立的若干个小问题，解决小问题，得到小问题的答案，然后合并小问题的答案，最终得到原始大问题的答案。

- 以下是一个外部排序的典型例子：二路外部归并排序。

  假设我们有一个大文件，里面是待排序的数据，一共 N 个，这些数据在内存中放不下。排序过程如下：

  1. 将该大文件分割成大小为 m 的文件（m 小于可用内存大小）
  1. 将这些小文件依次读入内存，在内存中采用任一种排序算法排序并输出文件 F1，F2….Fn。（其实可以和第一步合并，可以省一次 IO）
  1. 分块快读取两个已经排完序的文件 Fi 和 Fi+1，由于两个文件已经排完序，这里可以用归并排序，将两个文件排序完毕，并写入文件。（这个过程就好比有两队人马将其合并为一对一样）
  1. 重复过程 3，直到剩余文件数为 1。
  
  以上就是二路外部归并排序的基本思路，毫无疑问，这种排序算法需要读取外存（IO）次数为 log(2,N/m)，这时候算法的性能瓶颈已经不在内存中排序的时间复杂度上，而是内外存交换数据 IO 的次数了。

  二路归并排序的性能时比较低的，因此就有了多路归并排序算法，其 IO 的次数为 log(b, N/m)，其中 b 为几路归并。

todo: https://www.coursera.org/learn/gaoji-shuju-jiegou/lecture/wygDn/wen-jian-zu-zhi