- [数字水印：基础概念](#数字水印基础概念)
  - [1. 发展历史](#1-发展历史)
  - [2. 特性](#2-特性)
  - [3. 分类](#3-分类)
    - [3.1. 按特性划分](#31-按特性划分)
    - [3.2. 按附载媒体划分](#32-按附载媒体划分)
    - [3.3. 按检测过程划分](#33-按检测过程划分)
    - [3.4. 按内容划分](#34-按内容划分)
    - [3.5. 按用途划分](#35-按用途划分)
    - [3.6. 按透明性划分](#36-按透明性划分)
    - [3.7. 按隐藏位置划分](#37-按隐藏位置划分)
  - [4. 应用场景](#4-应用场景)
  - [5. 技术实现](#5-技术实现)
  - [6. Refer Links](#6-refer-links)

# 数字水印：基础概念

数字水印（Digital Watermarking）技术是将一些标识信息（即数字水印）直接嵌入数字载体当中（包括多媒体、文档、软件等）或是间接表示（修改特定区域的结构），且不影响原载体的使用价值，也不容易被探知和再次修改。但可以被生产方识别和辨认。通过这些隐藏在载体中的信息，可以达到确认内容创建者、购买者、传送隐秘信息或者判断载体是否被篡改等目的。数字水印是保护信息安全、实现防伪溯源、版权保护的有效办法，是信息隐藏技术研究领域的重要分支和研究方向。

## 1. 发展历史

数字水印技术是从信息隐藏技术发展而来的，是数字信号处理，图像处理，密码学应用，算法设计等学科的交叉领域。数字水印最早在 1993 年由 Tirkel 等人提出，在国际学术会议上发表题为“Electronic watermark”的第一篇有关水印的文章，提出了数字水印的概念及可能的应用，并针对灰度图像提出了两种向图像最低有效位中嵌入水印的算法。1996 年在英国剑桥牛顿研究所召开了第一届国际信息隐藏学术研讨会，标志着信息隐藏学的诞生。

## 2. 特性

数字水印系统必须满足一些特定的条件才能使其在数字产品版权保护和完整性鉴定方面成为值得信赖的应用体系。因此，一个安全可靠的数字水印系统一般应满足如下特性：

- 安全性 (Security)：数字水印的信息应是安全的，难以篡改或伪造，同时，应当有较低的误检测率，当原内容发生变化时，数字水印应当发生变化，从而可以检测原始数据的变更；当然数字水印同样对重复添加有很强的抵抗性。

- 隐蔽性 (Invisibility)：数字水印应是不可知觉的，而且应不影响被保护数据的正常使用；不会降质。

- 鲁棒性 (Robustness)：该特性适用于鲁棒水印。是指在经历多种无意或有意的信号处理过程后，数字水印仍能保持部分完整性并能被准确鉴别。可能的信号处理过程包括信道噪声、滤波、数 / 模与模 / 数转换、重采样、剪切、位移、尺度变化以及有损压缩编码等。

- 敏感性 (Sensitivity)：该特性适用于脆弱水印。是经过分发、传输、使用过程后，数字水印能够准确的判断数据是否遭受篡改。进一步的，可判断数据篡改位置、程度甚至恢复原始信息。

## 3. 分类

### 3.1. 按特性划分

按水印的特性可以将数字水印分为鲁棒数字水印和脆弱数字水印两类。

- **鲁棒水印** (Robust Watermarking) **主要用于在数字作品中标识著作权信息**，利用这种水印技术在多媒体内容的数据中嵌入创建者、所有者的标示信息，或者嵌入购买者的标示（即序列号）。在发生版权纠纷时，创建者或所有者的信息用于标示数据的版权所有者，而序列号用于追踪违反协议而为盗版提供多媒体数据的用户。用于版权保护的数字水印要求有很强的鲁棒性和安全性，除了要求在一般图像处理（如：滤波、加噪声、替换、压缩等）中生存外，还需能抵抗一些恶意攻击。

- **脆弱水印** (Fragile Watermarking) 与鲁棒水印的要求相反，脆弱数字水印**主要用于完整性保护和认证**，这种水印同样是在内容数据中嵌入不可见的信息。当内容发生改变时，这些水印信息会发生相应的改变，从而可以鉴定原始数据是否被篡改。根据脆弱水印的应用范围，脆弱水印又可分为选择性和非选择性脆弱水印：
  - 非选择性脆弱水印能够鉴别出比特位的任意变化。
  - 选择性脆弱水印能够根据应用范围选择对某些变化敏感。
  例如，图像的选择性脆弱水印可以实现对同一幅图像的不同格式转换不敏感，而对图像内容本身的处理（如：滤波、加噪声、替换、压缩等）又有较强的敏感性，即：既允许一定程度的失真，又要能将特定的失真情况探测出来。

### 3.2. 按附载媒体划分

按水印所附载的媒体，我们可以将数字水印划分为：
- **图像水印**
- **音频水印**
- **视频水印**
- **文本水印**
- **网格水印**（用于三维网格模型）

随着数字技术的发展，会有更多种类的数字媒体出现，同时也会产生相应的水印技术。

### 3.3. 按检测过程划分

按水印的检测过程可以将数字水印划分为盲水印和非盲水印。

- **盲水印**的检测不需要任何原始数据和辅助信息。盲水印的实用性强，应用范围广。

- **非盲水印**在检测过程中需要原始数据或者预留信息。一般来说，非盲水印的鲁棒性比较强，但其应用需要原始数据的辅助而受到限制。

- **半盲水印**：非盲水印中，新出现的半盲水印能够以少量的存储代价换来更低的误检率、漏检率，提高水印算法的性能。

目前学术界研究的数字水印大多数是盲水印或者半盲水印。

### 3.4. 按内容划分

按数字水印的内容可以将水印划分为有意义水印和无意义水印。

- **有意义水印**是指水印本身也是某个数字图像（如商标图像）或数字音频片段的编码。有意义水印的优势在于，如果由于受到攻击或其他原因致使解码后的水印破损，人们仍然可以通过视觉观察确认是否有水印。

- **无意义水印**则只对应于一个序列。对于无意义水印来说，如果解码后的水印序列有若干码元错误，则只能通过统计决策来确定信号中是否含有水印。

### 3.5. 按用途划分

不同的应用需求造就了不同的水印技术。按水印的用途，我们可以将数字水印划分为票证防伪水印、版权保护水印、篡改提示水印和隐蔽标识水印。

- **票证防伪水印**是一类比较特殊的水印，主要用于打印票据和电子票据、各种证件的防伪。一般来说，伪币的制造者不可能对票据图像进行过多的修改，所以，诸如尺度变换等信号编辑操作是不用考虑的。但另一方面，人们必须考虑票据破损、图案模糊等情形，而且考虑到快速检测的要求，用于票证防伪的数字水印算法不能太复杂。

- **版权标识水印**是目前研究最多的一类数字水印。数字作品既是商品又是知识作品，这种双重性决定了版权标识水印主要强调隐蔽性和鲁棒性，而对数据量的要求相对较小。

- **篡改提示水印**是一种脆弱水印，其目的是标识原文件信号的完整性和真实性。

- **隐蔽标识水印**的目的是将保密数据的重要标注隐藏起来，限制非法用户对保密数据的使用。

### 3.6. 按透明性划分

按数字水印是否透明的性质，可分为可见水印和不可见水印两种。

- **可见水印**就是人眼能看见的水印，比如照片上标记的拍照的日期或者电视频道上的标识等。

- **不可见水印**就是人类视觉系统难以感知的，也是当前数字水印领域关注比较多的。

### 3.7. 按隐藏位置划分

TODO:

按数字水印的隐藏位置，我们可以将其划分为时（空）域数字水印、频域数字水印、时 / 频域数字水印和时间 / 尺度域数字水印。

- **时域数字水印**是直接在信号空间上叠加水印信息。

- **频域数字水印**在 DCT 变换域上隐藏水印。

- **时 / 频域数字水印**在时 / 频变换域上隐藏水印。

- **时间 / 尺度域数字水印**在小波变换域上隐藏水印。

随着数字水印技术的发展，各种水印算法层出不穷，水印的隐藏位置也不再局限于上述四种。应该说，**只要构成一种信号变换，就有可能在其变换空间上隐藏水印**。

## 4. 应用场景

随着数字水印技术的发展，数字水印的应用领域也得到了扩展，数字水印的基本应用领域是防伪溯源、版权保护、隐藏标识、认证和安全隐蔽通信。

- 多媒体作品知识产权保护：利用数字水印的不可见性，在不影响作品的情况下，加入版权信息的数字水印，可抗击拷贝，剪切。

- 证件的防伪认证：如学历证，合同，票据等，携带数字水印后，可通过制定的方式提取水印，验证证件等数字文件是否被涂改。

- 隐蔽信息传递：水印可携带加密信息后，藏在多媒体文件中传播，并通过特定的提取方式获取水印。可以作为一种隐蔽信息的通信方式。
  - e.g. 阿里事件：阿里追查泄密员工的时间本身，说明，水印可以有效的追溯信息的释放源。

## 5. 技术实现

TODO:

1. 空域 -LSB

LSB 方法是最简单的嵌入水印的方法。事实上，任何一幅图片都具备一定的容噪性，这表现在像素数据的最低有效位 (LeastSignificant Bit，LSB) 对人眼的视觉影响很小，秘密信息就隐藏在图像每一个像素的最低位或次低位，实现其不可见性。

相关帖子推荐

LSB 基础实现：http://www.jianshu.com/p/8a89b6ba5e39

优化信息的嵌入位置，能够降低对图片的污染，影响图片质量；同时能够释放更多的图片边缘位置，从而携带更多的隐藏信息：https://github.com/Lixinyi-DUT/graduation-project/blob/master/%E7%BF%BB%E8%AF%91/

2. 频域

将图片的灰度强弱，视为图片的频域。通过某种变换手段（傅里叶变换，离散余弦变换，小波变换等）将图像变换到频域（小波域），在频域对图像添加水印，再通过逆变换，将图像转换为空间域。相对于空域手段，频域手段隐匿性更强，抗攻击性更高。

相关帖子推荐

阿里事件后，频域实现的良心贴：https://www.zhihu.com/question/50735753

3. DCT

DCT 以 8x8 的像素为单位进行，生成的是 8x8 的 DCT 系数数据块。DCT 变换的最大特点是对于一般的图像都能够将像块的能量集中于少数低频 DCT 系数上，即生成 8x8DCT 系数块中，仅左上角的少量低频系数数值较大，其余系数的数值很小，这样就可能只编码和传输少数系数而不严重影响图像质量。

相关帖子推荐

实现贴：http://www.programgo.com/article/88442707161/

科普贴：http://blog.sina.com.cn/s/blog_626631420100xvxd.html

4. 小波变换

“小波”就是小区域、长度有限、均值为 0 的波形。小波变换就是选择适当的基本小波或母小波ψ(t)，通过对基本小波的平移、伸缩而形成一系列的小波，这簇小波作为基可以构成一系列嵌套的（信号）子空间，然后将欲分析的信号（例如图像）投影到各个大小不同的（信号）子空间之中，以观察相应的特性。这样，就相当于我们用不同的焦距去观察一个物体，可从宏观到微观，从概貌到细节观察得十分详尽。所以小波变换又被称为“数学显微镜”。

相关帖子推荐

百科贴：http://baike.baidu.com/view/586841.htm

5. 空域 + 频域

该算法通过混沌置乱水印图像，建立水印与载体数据之间的 Hash 单向映射函数，使用两种不同的嵌入方法，先后嵌入水印到空域和 DFT 域。水印被多次嵌入，实现了水印的盲提取。

相关帖子推荐

该算法论文：https://www.google.com/patents/CN104680472A?cl=zh

TODO:

- 空间域（时间域）法

  早期的影像浮水印研究主要是发展在空间域中，以灰阶影像而言，每个取样点（pixel）一般是以八个位元来表示，且由最高有效位元（MSB）开始向右排列至最低有效位元（LSB），表示资料位元的重要性次序，因此可透过更改每个取样点中敏感度最低的 LSB 来嵌入浮水印资讯，使得浮水印具有较高的隐密性，这是资讯隐藏技术中最常被用来藏入资讯的一个既简单又容易实现的方法。但其缺点是容易被不法人士恶意破坏，且难以抵抗杂讯、压缩处理、影像处理以及剪切处理等各种攻击。

- 变换域法

  在频域中的浮水印主要是原始影像转换到频域里，在加入浮水印资料，将浮水印嵌入至不同频率成份讯号可满足不同需求，当嵌入至高频讯号，较不容易被人眼视觉系统所察觉，嵌入至低频成份讯号，由于能量较高因而不容易被破坏。

  - 离散余弦转换域

    离散馀弦转换是静态影像压缩技术（如 JPEG）以及动态视讯压缩技术（如 MPEG）中的主要核心，而从影像以 8*8 的像素区块为单位来做离散馀弦转换，转换后仍然以 8*8 的区块大小来表示频率资讯，其目的主要是将区块中各个像素的关联性打散，使得大部分的能量可以集中在少数几个基底函数上。

    以离散馀弦转换为工具，根据浮水印所嵌入的频带位置不同又分为：
    - 嵌入 DC 系数的浮水印技术
    - 嵌入低频系数的浮水印技术

  - 小波域

    离散小波转换也是一种可将影像的空间域资讯转换为频率域资讯的技术，其优点除了可以有效的将影像中各个像素的关联性打散之外，还提供了多重解析度与多频率的特性，使得在处理声音、影像以及视讯等资讯时的弹性较大，因此近年来被广泛的应用在影像处理、资料压缩以及资讯隐藏等研究领域。而离散小波转换可透过相对应的滤波器而分别作用在影像资讯中的列与行来实现

    以离散小波转换为工具，根据浮水印所嵌入的频带位置不同又分为：
    - 嵌入频带 HL1 的浮水印技术
    - 嵌入频带 LH2 的浮水印技术

## 6. Refer Links

[百度百科：数字水印](https://baike.baidu.com/item/%E6%95%B0%E5%AD%97%E6%B0%B4%E5%8D%B0)

[Wikipedia：数字水印](https://zh.wikipedia.org/wiki/%E6%95%B8%E4%BD%8D%E6%B5%AE%E6%B0%B4%E5%8D%B0)
