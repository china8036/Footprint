
- [计算机组成原理：外部 I/O - I/O 控制](#计算机组成原理外部-io---io-控制)
  - [1. 程序查询方式](#1-程序查询方式)
  - [2. 程序中断方式](#2-程序中断方式)
  - [3. 直接内存访问方式 (DMA)](#3-直接内存访问方式-dma)
  - [4. 通道方式](#4-通道方式)
  - [5. Refer Links](#5-refer-links)

# 计算机组成原理：外部 I/O - I/O 控制

在计算机系统中，CPU 管理外围 I/O 设备（与 I/O 设备的信息交换方式）主要分为软件控制 IO 和硬件控制 IO。

## 1. 程序查询方式

程序查询方式（程序控制 I/O 方式）是早期计算机中使用的一种方式，也是最简单的、最经济的输入输出方式，只需要少量的硬件支持。**数据在 CPU 和外围设备之间的传送完全靠计算机程序控制，是在 CPU 主动控制下进行的**。当需要输入输出时，CPU 暂停执行主程序，转去执行设备输入输出的服务程序，根据服务程序中的 I/O 指令进行数据传送。

![image](http://img.cdn.firejq.com/jpg/2019/2/14/7d0cbf8a3ad3f74a1c64c53111a56b8f.jpg)

优点：CPU 的操作和外围设备的操作能够同步，硬件结构比较简单。

缺点：外围设备动作很慢，程序进入查询循环时将白白浪费掉 CPU 很多时间。这种情况下，CPU 此时只能等待，不能处理其他业务。即使 CPU 采用定期地由主程序转向查询设备状态的子程序进行扫描轮询的办法，CPU 宝贵资源的浪费也是可观的。

应用：由于效率低，除单片机和数字信号处理机 DSP 外，大型机中不使用程序查询方式。

## 2. 程序中断方式

中断概念的出现，是计算机系统结构设计中的一个重大变革。**中断是指 CPU 暂时中止现行程序，转去处理随机发生的紧急事件，处理完后自动返回原程序的功能和技术**。通常，当一个中断发生时，CPU 暂停它的现行程序，而转向中断处理程序，从而可以输入或输出一个数据。当中断处理完毕后，CPU 又返回到它原来的任务，并从它停止的地方开始执行程序。

优点：
- 这种方式节省了 CPU 宝贵的时间，是管理 I/O 操作的一个比较有效的方法。

缺点：
- 同程序查询方式相比，硬件结构相对复杂一些。
- 用中断方式交换数据时，每处理一次 I/O 交换，约需几十微秒到几百微秒。对于一些高速的外围设备以及成组交换数据的情况，仍然显得速度太慢。

应用：中断方式特别适用于随机出现的服务，并且一旦提出要求，应立即进行。

## 3. 直接内存访问方式 (DMA)

直接内存访问 (DMA) 方式是一种完全由硬件执行 I/O 交换的工作方式。这种方式既考虑到中断响应，同时又要节约中断开销。此时，**DMA 控制器从 CPU 完全接管对总线的控制，数据交换不经过 CPU，而直接在内存和外围设备之间进行**，以高速传送数据。

优点：通过“权力下放”减轻了 CPU 对 I/O 操作的控制，由于 CPU 根本不参加传送操作，因此就省去了 CPU 取指令、取数、送数等操作。在数据传送过程中，没有保存现场、恢复现场之类的工作。内存地址修改、传送字个数的计数等等，也不是由软件实现，而是用硬件线路直接实现的。所以 DMA 方式能满足高速 I/O 设备的要求，也有利于 CPU 效率的发挥，传送速率仅受到内存访问时间的限制。

缺点：与中断方式相比，需要更多的硬件。

应用：DMA 方式适用于内存和高速外围设备之间大批数据交换的场合。

## 4. 通道方式

相比 DMA 方式，在通道方式中 CPU 将部分权力下放给通道，进一步提高了 CPU 的效率。**通道是一个具有特殊功能的处理器，某些应用中称为输入输出处理器 (IOP)，它有自己的指令和程序专门负责数据输入输出的传输控制，而 CPU 将“传输控制”的功能下放给通道后只负责“数据处理”功能，从而实现对外围设备的统一管理和外围设备与内存之间的数据传送**。通道与 CPU 分时使用内存，实现了 CPU 内部运算与 I/O 设备的平行工作。

优点：这种方式大大提高了 CPU 的工作效率。

缺点：这种提高 CPU 效率的办法是以花费更多硬件为代价的。

应用：通道方式大多用在大型计算机中。

## 5. Refer Links
