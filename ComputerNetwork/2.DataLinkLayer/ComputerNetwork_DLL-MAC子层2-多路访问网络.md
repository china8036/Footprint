- [计算机网络 - 数据链路层 - MAC 子层：多路访问网络](#计算机网络---数据链路层---mac-子层多路访问网络)
  - [1. 以太网 (Ethernet) IEEE 802.3](#1-以太网-ethernet-ieee-8023)
    - [1.1. 基本概念](#11-基本概念)
      - [1.1.1. 分类](#111-分类)
      - [1.1.2. 以太网编码](#112-以太网编码)
    - [1.2. 工作原理](#12-工作原理)
      - [1.2.1. 拓扑结构](#121-拓扑结构)
      - [1.2.2. 介质访问方式：二进制指数回退](#122-介质访问方式二进制指数回退)
    - [1.3. 以太网帧格式](#13-以太网帧格式)
      - [1.3.1. 前导码与帧起始字段](#131-前导码与帧起始字段)
      - [1.3.2. 目的地址和源地址字段](#132-目的地址和源地址字段)
      - [1.3.3. MAC 地址](#133-mac-地址)
      - [1.3.4. 类型 / 长度字段](#134-类型--长度字段)
  - [2. 无线局域网 IEEE 802.11](#2-无线局域网-ieee-80211)
  - [3. 宽带无线 IEEE 802.16](#3-宽带无线-ieee-80216)
  - [4. 蓝牙 IEEE 802.15](#4-蓝牙-ieee-80215)
  - [5. Refer Links](#5-refer-links)

# 计算机网络 - 数据链路层 - MAC 子层：多路访问网络

## 1. 以太网 (Ethernet) IEEE 802.3

### 1.1. 基本概念

#### 1.1.1. 分类

- 经典以太网
  - 3M~10Mbps
  - 不再使用

- 交换式以太网
  - 10M,100M,1G
  - 广泛使用

#### 1.1.2. 以太网编码

**以太网采用曼彻斯特编码**：
- 1：高电压到低电压
- 0：低电压到高电压

### 1.2. 工作原理

#### 1.2.1. 拓扑结构

#### 1.2.2. 介质访问方式：二进制指数回退

### 1.3. 以太网帧格式

https://en.wikipedia.org/wiki/Ethernet_frame

![image](http://otaivnlxc.bkt.clouddn.com/jpg/2018/6/10/fc48827a2545af91da4bf0a1e399fc3d.jpg)

因此，**以太网帧的最小长度为 64 Byte，最大长度为 1518 Byte**。

#### 1.3.1. 前导码与帧起始字段

- 前导码： 7 个字节， 10101010…101010 比特序列。
- 帧起始符： 1 字节， 10101011。

#### 1.3.2. 目的地址和源地址字段

- 地址字段长度： 2 个字节或 6 个字节 。
- 目的地址类型：
  - 单一结点地址（unicast address）。
  - 组播地址（multicast address）。
  - 广播地址（broadcast address）。

#### 1.3.3. MAC 地址

**MAC 地址用于在网络中唯一标示一个网卡，一台设备若有一或多个网卡，则每个网卡都需要并会有一个唯一的 MAC 地址，并且通常烧写在固件中**。

一般网卡 MAC 地址可以通过驱动程式或其他工具修改，而对于某些手机、平板电脑设备来说，其 MAC 地址／产品序号均由厂方连同销售或保修时的客户资料一并记录在案，因此有关的 MAC 地址也不可通过常规手段来修改。

根据 IEEE 规定，MAC 地址分为以下三种：
- MAC-48
  
  **MAC-48 是默认的 MAC 地址规范，地址空间 48 bit，占 6 个字节，支持 2^48 个 MAC 地址**。MAC-48 的设计目标是一百年内够用。
  
  以 16 进制数表示 MAC 地址，通用表示方法有三种格式，即破折号连接 01-23-45-67-89-ab、冒号连接 01:23:45:67:89:ab、句点连接 0123.4567.89ab。

  ![image](http://otaivnlxc.bkt.clouddn.com/jpg/2018/6/10/9401205f566d9510e175bb3b61d93965.jpg)
  - MAC-48 地址的前 3 字节表示 OUI（Organizationally Unique Identifier），由 IEEE 的注册管理机构给不同厂家分配的代码，区分不同的厂家。
  - 后 3 字节由厂家自行分配。
  - MAC 地址最高字节（MSB）的低第二位（LSb）表示这个 MAC 地址是全局的还是本地的，即 U/L（Universal/Local）位，如果为 0，表示是全局地址。所有的 OUI 这一位都是 0。
  - MAC 地址最高字节（MSB）的低第一位 (LSb），表示这个 MAC 地址是单播还是多播。0 表示单播。

- EUI-48

- EUI-64
  
  **IEEE EUI-64 地址代表网络接口寻址的新标准**。公司 ID 仍然是 24 位长度，但扩展 ID 是 40 位，从而为网络适配器制造商创建了更大的地址空间。EUI-64 地址使用 U/L 和 I/G 位的方式与 IEEE 802 地址相同。
  
  要从 IEEE 802 地址创建 EUI-64 地址，只需将 16 位的 11111111 11111110 (0xFFFE) 插入到 MAC-48 的公司 ID 和扩展 ID （即第三个和第四个字节）之间即可。例如一块网卡的 MAC 地址为：34-56-78-9A-BC-DE，那么其对应的接口标识应该为：36-56-78-FF-FE-9A-BC-DE。

- 特殊 MAC 地址
  - 广播地址：`ff:ff:ff:ff:ff:ff`
  - 多播地址：`01:xx:xx:xx:xx:xx`

#### 1.3.4. 类型 / 长度字段

在 DIX 以太帧中，type 字段指明上层网络协议的了类型，IX 以太帧是事实上的使用标准，通常抓取到的报文都是以太帧，该字段是类型字段。

在 IEEE 802.3 帧中， length 字段指明了携带的数据的长度。

怎么区分到底代表“类型”还是“长度”呢？检查这个字段的数值：如果小于等于 1536(0x600)，则是长度（802.3）字段，如果大于 1536，则表示类型（以太帧）。

- 以太网帧类型

  以太帧有很多种类型。不同类型的帧具有不同的格式和 MTU 值。但在同种物理媒体上都可同时存在：
  - lEthernet II 即 DIX2.0：Xerox 与 DEC、Intel 在 1982 年制定的以太网标准帧格式。Cisco 名称为：ARPA。
  - lEthernet 802.3 raw：Novell 在 1983 年公布的专用以太网标准帧格式。Cisco 名称为：Novell-Ether。
  - lEthernet 802.3 SAP：IEEE 在 1985 年公布的 Ethernet 802.3 的 SAP 版本以太网帧格式。Cisco 名称为：SAP。
  - lEthernet 802.3 SNAP：IEEE 在 1985 年公布的 Ethernet 802.3 的 SNAP 版本以太网帧格式。Cisco 名称为：SNAP。

  标准以太网接口缺省的 MTU 为 1500，而现在的以太网接口普遍可以通过配置使得 MTU 远远大于 1500。

  矮帧：矮帧是一个尺寸不及 IEEE 802.3 定义的最小长度 64 字节的以太网帧。可能的原因是以太网碰撞，数据不足，网卡错误或软件错误。

- 以太网帧长度

  Ethernet II 类型的**标准以太网帧的最小长度为 64 字节（6＋6＋2＋46＋4），最大长度为 1518 字节（6＋6＋2＋1500＋4）**。

  其中
  - 前 12 字节分别标识出发送数据帧的源节点 MAC 地址和接收数据帧的目标节点 MAC 地址。 
  - 接下来的 2 个字节标识出以太网帧所携带的上层数据类型，如 16 进制数 0x0800 代表 IP 协议数据，16 进制数 0x809B 代表 AppleTalk 协议数据，16 进制数 0x8138 代表 Novell 类型协议数据等。 
  - 在不定长的数据字段后是 4 个字节的帧校验序列（Frame Check Sequence，FCS），采用 32 位 CRC 循环冗余校验对从"目标 MAC 地址"字段到"数据"字段的数据进行校验。

## 2. 无线局域网 IEEE 802.11

## 3. 宽带无线 IEEE 802.16

## 4. 蓝牙 IEEE 802.15

## 5. Refer Links
