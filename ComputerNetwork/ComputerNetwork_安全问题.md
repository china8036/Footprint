- [TCP/IP 协议族主要协议安全问题](#tcpip-协议族主要协议安全问题)
  - [1. 主要协议安全问题](#1-主要协议安全问题)
    - [1.1. 数据链路层](#11-数据链路层)
      - [1.1.1. IEEE 以太网](#111-ieee-以太网)
      - [1.1.2. ARP](#112-arp)
      - [1.1.3. RARP](#113-rarp)
    - [1.2. 网络层](#12-网络层)
      - [1.2.1. IP](#121-ip)
      - [1.2.2. ICMP](#122-icmp)
    - [1.3. 传输层](#13-传输层)
      - [1.3.1. TCP](#131-tcp)
      - [1.3.2. UDP](#132-udp)
    - [1.4. 应用层](#14-应用层)
  - [2. 针对安全问题添加的“补丁”协议](#2-针对安全问题添加的补丁协议)

# TCP/IP 协议族主要协议安全问题

## 1. 主要协议安全问题

### 1.1. 数据链路层

#### 1.1.1. IEEE 以太网

安全缺陷：没有提供报文完整性和源地址的认证。

造成问题：
- 攻击：恶意节点以高速率发送大量广播报文，耗尽网络带宽，进行拒绝服务攻击。
- 定位难：可通过不断变换源 MAC 地址的方法来逃避追踪。

#### 1.1.2. ARP

安全缺陷：ARP 协议缺乏相应的认证机制，导致用户无法辨别 ARP 报文信息的真实性
- 支持“不请自来”的请求 (Unsolicited Requests) 
- 允许未经请求的 ARP 广播或单播对缓存条目的更新 
- ARP 缓存表可以远程更新且 ARP 无法验证更新消息的真实性 
- 代理 ARP 可以被利用

攻击方法：拒绝服务攻击，中间人攻击，MAC 洪泛，网络监听

#### 1.1.3. RARP

安全缺陷：RARP 被上层协议（DHCP，BOOTP）利用，允许主机通过 DHCP 和 BOOTP 服务自动配置自己的 IP 地址，缺乏必要的验证机制。

攻击方法：攻击者装一台 DHCP 服务器，向 DHCP 客户端传播错误的配置信息（服务器劫持），包括：错误的 IP 地址、网关、路由、域名服务器、NetBIOS、域信息等，导致客户端的数据流被重定向到攻击者设置的代理服务器，构成中间人攻击。 

### 1.2. 网络层

#### 1.2.1. IP

安全缺陷：**无状态、无认证**。

造成问题：
- 没有访问控制和带宽控制：阅读上层协议内容或利用包风暴消耗资源（拒绝服务攻击）.

- 寻址与协议选项：泄露了部分网络拓扑信息，可用于网络侦察。

- 数据包分片：IP 无状态，分片功能可用来绕过防火墙和入侵检测；还可用于攻击不能正确处理数据包分片异常的主机（拒绝服务攻击）。

- 数据包篡改：IP 没有来源认证和防数据包篡改机制，包中的所有内容几乎都可以伪造，可用于会话劫持、中间人攻击、伪造攻击等。

#### 1.2.2. ICMP

ICMP 目的：提高 IP 数据报交付成功的机会，允许主机或路由器报告差错情况和提供有关异常情况的报告。

ICMP 报文：
- ICMP 差错报告报文

- ICMP 询问报文 

  ![image](http://otaivnlxc.bkt.clouddn.com/jpg/2017/11/28/1c7625ea1f30806fc134e680e69eeae0.jpg)

造成问题：
- 利用目的站不可到达对目标发动拒绝服务攻击 
- 利用改变路由报文破坏路由表 
- 利用 ICMP 进行隐蔽通信 
- 利用回送请求或回答报文进行网络扫描或 DoS 

攻击方法：主机探测、Ping of Death 攻击、Smurf 攻击、重定向攻击。

### 1.3. 传输层

#### 1.3.1. TCP

安全缺陷：缺乏**认证机制**和**报文的完整性检查**，无法确认报文来源的真实性和数据的完整性。

攻击方法：通过伪造 TCP 报文进行各种攻击
- 网络扫描：利用 TCP 连接请求来进行端口扫描
- SYN Flood 攻击：TCP 连接数有限，DoS 攻击
- LAND 攻击：TCP 连接数有限，DoS 攻击
- 序列号猜测：会话劫持

#### 1.3.2. UDP

安全缺陷：无连接性，且没有任何认证机制和拥塞控制机制，容易伪造数据包。

攻击方法：UDP 洪泛攻击、Fraggle 攻击（与 Smurf 攻击类似）、Trinoo 攻击。

### 1.4. 应用层

- 邮件协议的缺陷：POP3 协议中用户名和密码以明文方式传输，容易被攻击者窃听 

- DNS 协议的缺陷：
  - 缺乏密码认证机制，可对 DNS 服务发动攻击
  - 加密 DNS

- FTP 协议缺陷：使用简单的用户名和密码认证机制。 

- Telnet 协议缺陷：用户名和口令明文传输

## 2. 针对安全问题添加的“补丁”协议

在网络设计之初，并没有考虑安全性的问题，因此，之后针对各种安全问题，添加了许多作为“补丁”的安全协议，保证网络传输的信息安全。

![image](http://otaivnlxc.bkt.clouddn.com/jpg/2017/12/19/cd4212fc305d4951baa7075f873ba116.jpg)

- 网络层：针对 IP 协议添加了 IPSEC 协议
- 传输层：针对 TCP 协议添加了 SSL/TLS 协议
- 应用层：
  - 针对 HTTP 协议添加了 HTTPS 协议
  - 针对 SMTP 协议添加了 PGP、SMIME 协议
  - 针对 TELNET 协议添加了 SSH 协议
  - 针对 DNS 协议添加了 DNSSEC 协议
  - 针对 SNMP 添加了 SNMPvS 协议