- [计算机网络 - 网络层：路由 - 路由算法](#计算机网络---网络层路由---路由算法)
  - [1. 基本概念](#1-基本概念)
  - [2. 静态路由 / 非自适应算法 (Nonadaptive algorithm)](#2-静态路由--非自适应算法-nonadaptive-algorithm)
    - [2.1. 迪杰斯特拉算法 (Dijkstra)](#21-迪杰斯特拉算法-dijkstra)
    - [2.2. 扩散 / 泛洪算法 (Flooding)](#22-扩散--泛洪算法-flooding)
  - [3. 动态路由 / 自适应算法 (Adaptive algorithm)](#3-动态路由--自适应算法-adaptive-algorithm)
    - [3.1. 基于拓扑结构进行路由](#31-基于拓扑结构进行路由)
      - [3.1.1. 距离矢量路由选择协议 (Distance Vector Route, DV)](#311-距离矢量路由选择协议-distance-vector-route-dv)
      - [3.1.2. 链路状态路由选择协议 (Link State Route, LS)](#312-链路状态路由选择协议-link-state-route-ls)
      - [3.1.3. 混合路由选择协议 (Hybrid)](#313-混合路由选择协议-hybrid)
      - [3.1.4. 多级路由 / 层次路由](#314-多级路由--层次路由)
      - [3.1.5. 广播路由](#315-广播路由)
      - [3.1.6. 组播路由](#316-组播路由)
      - [3.1.7. 选播路由](#317-选播路由)
      - [3.1.8. 移动主机路由](#318-移动主机路由)
      - [3.1.9. 自组织网络路由](#319-自组织网络路由)
      - [3.1.10. adhoc 路由](#3110-adhoc-路由)
      - [3.1.11. pp 路由](#3111-pp-路由)
    - [3.2. 基于流量进行路由](#32-基于流量进行路由)
  - [4. Refer Links](#4-refer-links)

# 计算机网络 - 网络层：路由 - 路由算法

## 1. 基本概念

网络层的主要功能是将数据包从源端机器路由到目标机器，因此路由的选择算法和这些算法所用的数据结构是网络层设计的最主要内容。

路由算法是网路层软件的一部分，负责确定一个入境数据包应该被发送到哪一条输出线路上。

路由选择算法必须满足的特性：
- 正确性
- 简单性 (KISS)
- 鲁棒性（robustness）
- 稳定性
- 公平性
- 有效性 (contradictory、trade-off)

## 2. 静态路由 / 非自适应算法 (Nonadaptive algorithm)

静态路由 / 非自适应算法 (nonadaptive algorithm) 不会根据当前测量或估计的流量和拓扑结构来调整其路由决策。其适用的路由选择是预先在离线情况下计算好并在网络启动时被下载到路由器中，或是由管理员手工配置的。

**由于这种算法无法响应故障，因此只适用于路由选择已经十分清楚的场合**。

### 2.1. 迪杰斯特拉算法 (Dijkstra)

### 2.2. 扩散 / 泛洪算法 (Flooding)

泛洪算法将每一个入境数据包发送到除了该数据包到达的那条线路以外的每条出境线路。由于泛洪会产生大量的重复数据包，因此可在每个数据包的头中设置一个跳计数器，每经过一跳就将该计数器减一，当该计数器到达 0 时就丢弃该数据包。

对于发送大多数数据包来说，泛洪算法是不切实际的，但其也有一些重要的用途：
- 能够确保数据包能被传送到网络中的每个节点。
- 若数据包的目的地只有一个，泛洪是一种浪费；若对于广播信息，泛洪是一种有效的广播手段。
- **泛洪途径具有很好的鲁棒性。即使在战争地区，也能利用仅存的少量路由器找到可能存在的路径将数据包送达目的地**。

## 3. 动态路由 / 自适应算法 (Adaptive algorithm)

动态路由 / 自适应算法 (adaptive algorithm) 会根据拓扑结构的变化来改变其路由决策，通常也会反映出流量的变化。算法除了从源端发送至目的端，还有传递模式。

- 动态如何实现？
  - **路由器之间要通信，因此所有路由器必须运行着同一种路由选择协议**。
  - **一台新的路由器必须主动介绍它自己 (say hello)**。
  - **周期性地联系，以了解其它路由器的健康状况 (keep alive)**。

- 最优化原则

  最优路径的一般陈述如下：如果路由器 C 在从路由器 A 到路由器 B 的最优路径上，那么从 C 到 B 的最优路径也必定遵循同样的路由。

- 汇集树

  **从所有源节点到一个指定目的节点的最佳路径形成了以目的节点为根的树，这棵树称为汇集树。所有路由算法的目标就是为所有路由器找到这样的汇集树**。

  汇集树不一定是唯一的，可能会存在具有相同路径长度的其它汇集树。**如果允许选择所有可能的路径，则会构成一个有向无环图 DAG**。

### 3.1. 基于拓扑结构进行路由

#### 3.1.1. 距离矢量路由选择协议 (Distance Vector Route, DV)

每个路由器维护一张表（即一个矢量），表中列出了当前已知的到每个目标的最佳距离，以及所使用的链路。这些表通过邻居之间的相互交换信息而不断被更新，最终每个路由器都了解到达每个目的地的最佳链路。

实际上，**距离矢量路由选择的过程就是在整个网络运行一个 Dijkstra 算法**。

存在问题：当网络拓扑结构发生变化后，距离矢量路由算法需要太长时间才能收敛到稳定状态（由于无穷计数问题）。

应用：距离矢量路由算法是最初 ARPANET 适用的路由算法，也曾被用于 Internet，相应的协议为 RIP 协议、BGP 协议

#### 3.1.2. 链路状态路由选择协议 (Link State Route, LS)

链路状态路由的主要设计思想包括如下 5 个部分，每个路由器都必须完成以下事情，整个算法才能正常工作：
- 发现它的邻居节点们，了解它们的网络地址。
- 设置到它的每个邻居的成本度量。
- 构造一个分组，包含它所了解到的所有信息。
- 发送这个分组给所有其他的路由器。
- 计算到每个路由器的最短路径。

实际上，**链路状态路由算法将完整的拓扑结构分发给每一个路由器，每个路由器都运行 dijkstra 算法，从而可找出从本地到每一个其它路由器的最短路径**。

应用：**链路状态路由算法的变种算法 -- 开放的最短路径优先链路状态协议 (OSPF) 和中间系统到中间系统链路状态协议 (IS-IS) 算法成为如今使用最为广泛的路由算法**。

#### 3.1.3. 混合路由选择协议 (Hybrid)

应用：EIGRP。

#### 3.1.4. 多级路由 / 层次路由

#### 3.1.5. 广播路由

#### 3.1.6. 组播路由

#### 3.1.7. 选播路由

#### 3.1.8. 移动主机路由

#### 3.1.9. 自组织网络路由

#### 3.1.10. adhoc 路由

#### 3.1.11. pp 路由

### 3.2. 基于流量进行路由

基于流量的路由算法在传输层 TCP 协议的拥塞控制算法中实现。

## 4. Refer Links